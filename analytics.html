<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SocialSentiment | Analytics</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="logo-container">
            <div class="logo">SS</div>
            <div class="logo-text">SocialSentiment</div>
        </div>
        
        <nav class="nav-menu">
            <div class="nav-item">
                <a href="index.html" class="nav-link">
                    <i class="fas fa-home nav-icon"></i>
                    <span class="nav-text">Dashboard</span>
                    <span class="nav-tooltip">Dashboard</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="analytics.html" class="nav-link active">
                    <i class="fas fa-chart-pie nav-icon"></i>
                    <span class="nav-text">Analytics</span>
                    <span class="nav-tooltip">Analytics</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="sentiment.html" class="nav-link">
                    <i class="fas fa-smile nav-icon"></i>
                    <span class="nav-text">Sentiment</span>
                    <span class="nav-tooltip">Sentiment</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="alerts.html" class="nav-link">
                    <i class="fas fa-bell nav-icon"></i>
                    <span class="nav-text">Alerts</span>
                    <span class="nav-tooltip">Alerts</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="settings.html" class="nav-link">
                    <i class="fas fa-cog nav-icon"></i>
                    <span class="nav-text">Settings</span>
                    <span class="nav-tooltip">Settings</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="#" class="nav-link" id="logout-btn">
                    <i class="fas fa-sign-out-alt nav-icon"></i>
                    <span class="nav-text">Logout</span>
                    <span class="nav-tooltip">Logout</span>
                </a>
            </div>
        </nav>
    </aside>

    <!-- Main Content Area -->
    <main class="main-content">
        <header class="header">
            <div class="search-bar">
                <i class="fas fa-search search-icon"></i>
                <input type="text" placeholder="Search for posts, mentions, or users...">
            </div>
            
            <div class="user-menu">
                <div class="header-action notification-bell">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </div>
                <div class="header-action">
                    <i class="fas fa-envelope"></i>
                </div>
                <div class="header-action">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div class="user-profile">
                    <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="User" class="user-avatar">
                    <div>
                        <div class="user-name">Sarah Johnson</div>
                        <div class="user-role">Admin</div>
                    </div>
                </div>
            </div>
        </header>

        <h1 class="page-title">
            <i class="fas fa-chart-pie"></i>
            Advanced Analytics
        </h1>
        <p class="page-subtitle">Deep dive into social media performance metrics</p>
        
        <!-- Time Period Selector -->
        <div class="card">
            <div class="analysis-tabs">
                <button class="tab-btn active" data-tab="overview">Overview</button>
                <button class="tab-btn" data-tab="comparison">Comparison</button>
                <button class="tab-btn" data-tab="demographics">Demographics</button>
            </div>
            
            <div class="tab-content active" id="overview-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-chart-line"></i>
                            Mentions Trend
                        </div>
                        <div class="chart-container" style="height: 150px;">
                            <canvas id="mentionsTrendChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-users"></i>
                            Audience Growth
                        </div>
                        <div class="chart-container" style="height: 150px;">
                            <canvas id="audienceGrowthChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-share-alt"></i>
                            Engagement Rate
                        </div>
                        <div class="chart-container" style="height: 150px;">
                            <canvas id="engagementRateChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-hashtag"></i>
                            Top Hashtags
                        </div>
                        <div class="keyword-cloud" style="margin-top: 0.5rem;">
                            <div class="keyword neutral">#socialmedia</div>
                            <div class="keyword positive">#happy</div>
                            <div class="keyword negative">#disappointed</div>
                            <div class="keyword positive">#loveit</div>
                            <div class="keyword neutral">#update</div>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container" style="height: 400px; margin-top: 1.5rem;">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
            
            <div class="tab-content" id="comparison-content">
                <div class="chart-container" style="height: 400px;">
                    <canvas id="platformComparisonChart"></canvas>
                </div>
                
                <div class="stats-grid" style="margin-top: 1.5rem;">
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fab fa-facebook"></i>
                            Facebook Performance
                        </div>
                        <div class="stat-value">8,742</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> 5.2%
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fab fa-twitter"></i>
                            Twitter Performance
                        </div>
                        <div class="stat-value">6,521</div>
                        <div class="stat-change neutral">
                            <i class="fas fa-minus"></i> 0.3%
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fab fa-instagram"></i>
                            Instagram Performance
                        </div>
                        <div class="stat-value">9,345</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> 8.7%
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fab fa-youtube"></i>
                            YouTube Performance
                        </div>
                        <div class="stat-value">5,231</div>
                        <div class="stat-change negative">
                            <i class="fas fa-arrow-down"></i> 1.2%
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="demographics-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-venus-mars"></i>
                            Gender Distribution
                        </div>
                        <div class="chart-container" style="height: 200px;">
                            <canvas id="genderChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-map-marker-alt"></i>
                            Geographic Distribution
                        </div>
                        <div class="chart-container" style="height: 200px;">
                            <canvas id="geoChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-birthday-cake"></i>
                            Age Distribution
                        </div>
                        <div class="chart-container" style="height: 200px;">
                            <canvas id="ageChart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-clock"></i>
                            Activity Times
                        </div>
                        <div class="chart-container" style="height: 200px;">
                            <canvas id="activityChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Content Performance -->
        <div class="card">
            <h2 class="card-title">
                <i class="fas fa-poll"></i>
                Content Performance
            </h2>
            
            <div class="analysis-tabs">
                <button class="tab-btn active" data-tab="top-performing">Top Performing</button>
                <button class="tab-btn" data-tab="worst-performing">Worst Performing</button>
                <button class="tab-btn" data-tab="content-types">Content Types</button>
            </div>
            
            <div class="tab-content active" id="top-performing-content">
                <div class="post-list">
                    <div class="post-card">
                        <div class="post-header">
                            <img src="https://randomuser.me/api/portraits/women/22.jpg" alt="User" class="post-avatar">
                            <div>
                                <div class="post-user">Sarah Johnson</div>
                                <div class="post-meta">
                                    <span>2 days ago</span>
                                    <span class="post-platform">
                                        <i class="fab fa-youtube"></i> YouTube
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="post-content">
                            Just created a full review video of the product. The build quality is exceptional and the performance exceeds my expectations. Definitely recommend!
                        </div>
                        <div class="post-sentiment positive">
                            <i class="fas fa-smile"></i> 95% Positive
                        </div>
                        <div class="stats-grid" style="margin-top: 1rem; grid-template-columns: repeat(4, 1fr);">
                            <div>
                                <div class="stat-title">Reach</div>
                                <div class="stat-value">12.5K</div>
                            </div>
                            <div>
                                <div class="stat-title">Engagement</div>
                                <div class="stat-value">1.8K</div>
                            </div>
                            <div>
                                <div class="stat-title">Shares</div>
                                <div class="stat-value">542</div>
                            </div>
                            <div>
                                <div class="stat-title">CTR</div>
                                <div class="stat-value">8.2%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="post-card">
                        <div class="post-header">
                            <img src="https://randomuser.me/api/portraits/men/65.jpg" alt="User" class="post-avatar">
                            <div>
                                <div class="post-user">TechReviewGuy</div>
                                <div class="post-meta">
                                    <span>3 days ago</span>
                                    <span class="post-platform">
                                        <i class="fab fa-twitter"></i> Twitter
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="post-content">
                            The new features in this update are game-changers! Especially love the improved performance and battery life. Great work from the team!
                        </div>
                        <div class="post-sentiment positive">
                            <i class="fas fa-smile"></i> 89% Positive
                        </div>
                        <div class="stats-grid" style="margin-top: 1rem; grid-template-columns: repeat(4, 1fr);">
                            <div>
                                <div class="stat-title">Reach</div>
                                <div class="stat-value">8.7K</div>
                            </div>
                            <div>
                                <div class="stat-title">Engagement</div>
                                <div class="stat-value">1.2K</div>
                            </div>
                            <div>
                                <div class="stat-title">Shares</div>
                                <div class="stat-value">387</div>
                            </div>
                            <div>
                                <div class="stat-title">CTR</div>
                                <div class="stat-value">6.5%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="worst-performing-content">
                <div class="post-list">
                    <div class="post-card">
                        <div class="post-header">
                            <img src="https://randomuser.me/api/portraits/women/45.jpg" alt="User" class="post-avatar">
                            <div>
                                <div class="post-user">CustomerSupportHelp</div>
                                <div class="post-meta">
                                    <span>1 day ago</span>
                                    <span class="post-platform">
                                        <i class="fab fa-facebook-f"></i> Facebook
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="post-content">
                            Extremely disappointed with the customer service response time. Been waiting for 5 days now with no resolution to my issue. This is unacceptable!
                        </div>
                        <div class="post-sentiment negative">
                            <i class="fas fa-frown"></i> 15% Positive
                        </div>
                        <div class="stats-grid" style="margin-top: 1rem; grid-template-columns: repeat(4, 1fr);">
                            <div>
                                <div class="stat-title">Reach</div>
                                <div class="stat-value">6.2K</div>
                            </div>
                            <div>
                                <div class="stat-title">Engagement</div>
                                <div class="stat-value">945</div>
                            </div>
                            <div>
                                <div class="stat-title">Shares</div>
                                <div class="stat-value">287</div>
                            </div>
                            <div>
                                <div class="stat-title">CTR</div>
                                <div class="stat-value">4.8%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="post-card">
                        <div class="post-header">
                            <img src="https://randomuser.me/api/portraits/men/33.jpg" alt="User" class="post-avatar">
                            <div>
                                <div class="post-user">AngryUser123</div>
                                <div class="post-meta">
                                    <span>2 days ago</span>
                                    <span class="post-platform">
                                        <i class="fab fa-twitter"></i> Twitter
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="post-content">
                            The latest update completely broke the app for me. Can't believe this was released without proper testing. Fix this ASAP!
                        </div>
                        <div class="post-sentiment negative">
                            <i class="fas fa-frown"></i> 12% Positive
                        </div>
                        <div class="stats-grid" style="margin-top: 1rem; grid-template-columns: repeat(4, 1fr);">
                            <div>
                                <div class="stat-title">Reach</div>
                                <div class="stat-value">5.8K</div>
                            </div>
                            <div>
                                <div class="stat-title">Engagement</div>
                                <div class="stat-value">872</div>
                            </div>
                            <div>
                                <div class="stat-title">Shares</div>
                                <div class="stat-value">231</div>
                            </div>
                            <div>
                                <div class="stat-title">CTR</div>
                                <div class="stat-value">3.9%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="content-types-content">
                <div class="chart-container" style="height: 400px;">
                    <canvas id="contentTypesChart"></canvas>
                </div>
                
                <div class="stats-grid" style="margin-top: 1.5rem;">
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-image"></i>
                            Image Posts
                        </div>
                        <div class="stat-value">3,245</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> 7.2%
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-video"></i>
                            Video Posts
                        </div>
                        <div class="stat-value">2,187</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> 12.5%
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-font"></i>
                            Text Posts
                        </div>
                        <div class="stat-value">1,876</div>
                        <div class="stat-change negative">
                            <i class="fas fa-arrow-down"></i> 3.1%
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-title">
                            <i class="fas fa-link"></i>
                            Link Posts
                        </div>
                        <div class="stat-value">987</div>
                        <div class="stat-change neutral">
                            <i class="fas fa-minus"></i> 0.5%
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2 class="card-title">
                <i class="fas fa-comment-dots"></i>
                Analyze Text Sentiment
            </h2>
            <textarea id="sentimentInput" rows="3" class="form-control" placeholder="Type text to analyze..."></textarea>
            <div id="sentimentResult" style="margin-top:1em;font-weight:bold;"></div>
        </div>
    </main>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/script.js"></script>
    <script src="js/profile-sync.js"></script>
    <script>
        // Additional charts for analytics page
        document.addEventListener('DOMContentLoaded', function() {
            // Mentions Trend Chart
            const mentionsCtx = document.getElementById('mentionsTrendChart').getContext('2d');
            new Chart(mentionsCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Mentions',
                        data: [1200, 1900, 1700, 2100, 2300, 2500],
                        borderColor: '#4361ee',
                        backgroundColor: 'rgba(67, 97, 238, 0.1)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                drawBorder: false
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Audience Growth Chart
            const audienceCtx = document.getElementById('audienceGrowthChart').getContext('2d');
            new Chart(audienceCtx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Followers',
                        data: [5000, 7000, 8500, 9200, 10500, 12000],
                        backgroundColor: '#10b981',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                drawBorder: false
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Performance Chart
            const performanceCtx = document.getElementById('performanceChart').getContext('2d');
            new Chart(performanceCtx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [
                        {
                            label: 'Positive',
                            data: [850, 920, 1020, 1150, 1250, 1400],
                            backgroundColor: '#10b981',
                            borderRadius: 4
                        },
                        {
                            label: 'Neutral',
                            data: [250, 300, 350, 400, 450, 500],
                            backgroundColor: '#f59e0b',
                            borderRadius: 4
                        },
                        {
                            label: 'Negative',
                            data: [100, 80, 130, 150, 100, 200],
                            backgroundColor: '#ef4444',
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                drawBorder: false
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Platform Comparison Chart
            const platformCtx = document.getElementById('platformComparisonChart').getContext('2d');
            new Chart(platformCtx, {
                type: 'radar',
                data: {
                    labels: ['Engagement', 'Reach', 'Sentiment', 'Growth', 'Activity'],
                    datasets: [
                        {
                            label: 'Facebook',
                            data: [75, 85, 80, 70, 65],
                            backgroundColor: 'rgba(24, 119, 242, 0.2)',
                            borderColor: '#1877f2',
                            borderWidth: 2
                        },
                        {
                            label: 'Twitter',
                            data: [65, 60, 70, 55, 75],
                            backgroundColor: 'rgba(29, 161, 242, 0.2)',
                            borderColor: '#1da1f2',
                            borderWidth: 2
                        },
                        {
                            label: 'Instagram',
                            data: [85, 75, 90, 80, 70],
                            backgroundColor: 'rgba(224, 53, 102, 0.2)',
                            borderColor: '#e1306c',
                            borderWidth: 2
                        },
                        {
                            label: 'YouTube',
                            data: [70, 65, 75, 60, 80],
                            backgroundColor: 'rgba(255, 0, 0, 0.2)',
                            borderColor: '#ff0000',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    }
                }
            });

            // Demographic Charts
            const genderCtx = document.getElementById('genderChart').getContext('2d');
            new Chart(genderCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Male', 'Female', 'Other'],
                    datasets: [{
                        data: [55, 40, 5],
                        backgroundColor: [
                            '#3b82f6',
                            '#ec4899',
                            '#64748b'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });

            const ageCtx = document.getElementById('ageChart').getContext('2d');
            new Chart(ageCtx, {
                type: 'bar',
                data: {
                    labels: ['18-24', '25-34', '35-44', '45-54', '55+'],
                    datasets: [{
                        label: 'Users',
                        data: [25, 40, 20, 10, 5],
                        backgroundColor: '#4361ee',
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                drawBorder: false
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });

            // Content Types Chart
            const contentCtx = document.getElementById('contentTypesChart').getContext('2d');
            new Chart(contentCtx, {
                type: 'pie',
                data: {
                    labels: ['Images', 'Videos', 'Text', 'Links'],
                    datasets: [{
                        data: [35, 30, 25, 10],
                        backgroundColor: [
                            '#3b82f6',
                            '#ef4444',
                            '#10b981',
                            '#f59e0b'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        });

        // Sentiment analysis as you type
        document.addEventListener('DOMContentLoaded', function() {
            const input = document.getElementById('sentimentInput');
            const resultDiv = document.getElementById('sentimentResult');
            let timeout = null;
            if (input) {
                input.addEventListener('input', function() {
                    clearTimeout(timeout);
                    const text = input.value.trim();
                    if (!text) {
                        resultDiv.textContent = '';
                        return;
                    }
                    resultDiv.textContent = 'Analyzing...';
                    timeout = setTimeout(async () => {
                        try {
                            const res = await fetch('http://localhost:5001/api/sentiment', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ text })
                            });
                            if (res.ok) {
                                const data = await res.json();
                                let color = '#10b981';
                                if (data.sentiment === 'negative') color = '#ef4444';
                                else if (data.sentiment === 'neutral') color = '#f59e0b';
                                resultDiv.innerHTML = `Sentiment: <span style="color:${color}">${data.sentiment.toUpperCase()}</span>`;
                            } else {
                                let errorMsg = 'Error analyzing sentiment.';
                                try {
                                    const errData = await res.json();
                                    if (errData && errData.error) errorMsg += `\n${errData.error}`;
                                } catch {}
                                resultDiv.textContent = errorMsg;
                                resultDiv.style.color = '#ef4444';
                            }
                        } catch (err) {
                            resultDiv.textContent = 'Server error. Please try again.\n' + (err.message || '') + '\nIs the backend running at http://localhost:5001?';
                            resultDiv.style.color = '#ef4444';
                        }
                    }, 400);
                });
            }
        });
    </script>
</body>
</html>